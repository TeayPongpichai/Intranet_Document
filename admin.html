<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Admin ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</title>
  <style>
    /* ‚úÖ CSS ‡∏à‡∏≤‡∏Å style.css ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ */
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background-color: #eaf2ec;
      color: #003f2d;
      margin: 30px;
    }
    h2 { color: #003f2d; margin-bottom: 20px; }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      margin-top: 20px;
      font-size: 0.9em;
    }
    th, td { padding: 10px; border-bottom: 1px solid #ccc; text-align: left; }
    th { background-color: #3B7168; color: white; font-weight: bold; }

    button, .green-button {
      background-color: #3B7168;
      color: white;
      padding: 8px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { background-color: #2b5a52; }

    input[type="text"], input[type="date"], input[type="password"] {
      padding: 6px; margin: 4px 0; width: 250px;
      border: 1px solid #ccc; border-radius: 4px;
    }
    a { color: #3B7168; text-decoration: none; font-weight: bold; }
    a:hover { text-decoration: underline; }

    .status { margin-top: 10px; font-weight: bold; color: #00695c; }
    .status.error { color: red; }
    .status.success { color: green; }
    .status.loading { color: #888; font-style: italic; }

    form {
      margin-top: 20px; padding: 10px; background-color: #ffffff;
      border: 1px solid #c8e6c9; border-radius: 6px; max-width: 600px;
      box-shadow: 0 0 5px rgba(0,0,0,0.05);
    }
    form label { display: block; margin-top: 10px; font-weight: bold; color: #004d40; }
    form input { display: block; margin-bottom: 10px; }

    @media (max-width: 600px) {
      table, thead, tbody, th, td, tr { display: block; width: 100%; }
      th { text-align: right; padding-right: 30%; }
      td { text-align: left; padding-left: 5%; }
      input[type="text"], input[type="date"], input[type="password"] { width: 100%; }
      button { width: 100%; margin-top: 5px; }
    }

    /* ‚úÖ CSS ‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Admin */
    .hidden { display: none; }
    .category-radio { display: flex; gap: 20px; align-items: center; margin: 10px 0; }
    .category-radio label { font-weight: bold; }
    .filetype-radio { display: flex; gap: 15px; align-items: center; margin: 10px 0; }
    .filetype-radio label { display: flex; align-items: center; gap: 5px; }

    .expired-header { margin-top: 10px; font-size: 1em; font-weight: bold; color: #3B7168; }
    .flex-container { display: flex; gap: 5px; align-items: flex-start; }
    .left-form { flex: 3.5; min-width: 0; }
    .right-expired { flex: 6.5; min-width: 0; }

    #expiredTable th, #expiredTable td { text-align: center; }
  </style>
</head>
<body>
  <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• (Admin)</h2>

  <div id="passwordSection">
    <input type="password" id="adminPassword" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
    <button onclick="checkPassword()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    <div id="passwordStatus" class="status"></div>
  </div>

  <div id="adminPanel" class="hidden">
    <h2>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>

    <div class="category-radio">
      <label>üìÇ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</label>
      <label><input type="radio" name="category" value="master" checked> üìã ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</label>
      <label><input type="radio" name="category" value="patient"> üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</label>
    </div>

    <label>üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</label>
    <input type="text" id="searchCode" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£">
    <button onclick="searchDoc()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
    <button onclick="clearForm()">‡∏•‡πâ‡∏≤‡∏á</button>

    <hr>

    <div class="flex-container">
      <div class="left-form">
        <form id="docForm">
          <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô:</label><br>
          <input type="text" id="dept" required><br>

          <label>‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</label><br>
          <input type="text" id="code" required><br>

          <label>‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</label><br>
          <input type="text" id="rev" required><br>

          <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</label><br>
          <input type="text" id="title" required><br>

          <label>‚úÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ:</label><br>
          <input type="date" id="startDate" required><br>

          <label>‚õî ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label><br>
          <input type="date" id="endDate"><br>

          <label>üìÑ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå:</label>
          <div class="filetype-radio">
            <label><input type="radio" name="fileTypeRadio" value="PDF">PDF</label>
            <label><input type="radio" name="fileTypeRadio" value="WORD">WORD</label>
            <label><input type="radio" name="fileTypeRadio" value="EXCEL">EXCEL</label>
            <label><input type="radio" name="fileTypeRadio" value="other">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ:</label>
            <input type="text" id="fileType" placeholder="‡∏£‡∏∞‡∏ö‡∏∏ ‡πÄ‡∏ä‡πà‡∏ô PPT, TXT" disabled>
          </div>

          <label>üñ®Ô∏è ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏¥‡πâ‡∏ô:</label>
          <div class="filetype-radio">
            <label><input type="radio" name="printType" value="-" checked> ‡πÑ‡∏°‡πà‡∏°‡∏µ</label>
            <label><input type="radio" name="printType" value="‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á"> ‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á</label>
          </div>

          <label>üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏£‡∏∑‡∏≠ path:</label><br>
          <input type="text" id="link" required><br><br>

          <button type="button" onclick="addDoc()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å / ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button type="button" onclick="deleteDoc()">üóëÔ∏è ‡∏•‡∏ö</button>
        </form>

        <pre id="status" class="status"></pre>
      </div>

      <div class="right-expired">
        <div class="expired-header">üìÅ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß</div>
        <table id="expiredTable">
          <thead>
            <tr>
              <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
              <th>‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</th>
              <th>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ä‡πâ</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</th>
              <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå</th>
              <th>Download</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div id="expiredPagination"></div>
      </div>
    </div>
  </div>

  <script>
    /* ===== ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ===== */
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbykNCPNYmKCuCaA7mUcusnHEAQqmSomudpmPJDYp2qucwuzBDR_lNWJH2YYSJaMBo2KuA/exec';
    const ADMIN_PASSWORD = '1234';

    /* ===== ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ===== */
    let currentData = [];
    let expiredPage = 1;
    let expiredTotalPages = 1;
    const EXPIRED_PAGE_SIZE = 10;

    /* ===== Auth ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ===== */
    function checkPassword() {
      const input = document.getElementById("adminPassword").value;
      if (input === ADMIN_PASSWORD) {
        document.getElementById("passwordSection").style.display = "none";
        document.getElementById("adminPanel").classList.remove("hidden");
        loadData(); // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á await
      } else {
        document.getElementById("passwordStatus").textContent = "‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
      }
    }

    /* ===== ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ===== */
    function renderExpiredTable() {
      const tbody = document.querySelector("#expiredTable tbody");
      tbody.innerHTML = "";

      const today = new Date();

      // ‡∏Ñ‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‚Üí‡πÄ‡∏Å‡πà‡∏≤
      const expired = currentData
        .filter(item => item.endDate && new Date(item.endDate) < today)
        .sort((a, b) => new Date(b.endDate) - new Date(a.endDate));

      expiredTotalPages = Math.max(1, Math.ceil(expired.length / EXPIRED_PAGE_SIZE));
      if (expiredPage > expiredTotalPages) expiredPage = expiredTotalPages;

      const start = (expiredPage - 1) * EXPIRED_PAGE_SIZE;
      const pageItems = expired.slice(start, start + EXPIRED_PAGE_SIZE);

      if (pageItems.length === 0) {
        const row = document.createElement("tr");
        row.innerHTML = `<td colspan="6" style="text-align:center;">‚Äî ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‚Äî</td>`;
        tbody.appendChild(row);
      } else {
        pageItems.forEach(item => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${item.dept}</td>
            <td>${item.code}</td>
            <td>${item.startDate}</td>
            <td>${item.endDate}</td>
            <td>${item.fileType || '-'}</td>
            <td><a href="${item.link}" target="_blank">Click</a></td>
          `;
          tbody.appendChild(row);
        });
      }

      renderExpiredPagination();
    }

    function renderExpiredPagination() {
      const container = document.getElementById("expiredPagination");
      container.innerHTML = "";
      if (expiredTotalPages <= 1) return;

      const makeBtn = (label, onClick, disabled = false) => {
        const btn = document.createElement("button");
        btn.textContent = label;
        btn.className = "green-button";
        btn.style.marginRight = "6px";
        btn.disabled = disabled;
        btn.onclick = onClick;
        return btn;
      };

      container.appendChild(
        makeBtn("‚èÆ ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤", () => goExpiredPage(expiredPage - 1), expiredPage === 1)
      );

      const info = document.createElement("span");
      info.textContent = ` ‡∏´‡∏ô‡πâ‡∏≤ ${expiredPage} / ${expiredTotalPages} `;
      info.style.margin = "0 8px";
      info.style.fontWeight = "bold";
      container.appendChild(info);

      container.appendChild(
        makeBtn("‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚è≠", () => goExpiredPage(expiredPage + 1), expiredPage === expiredTotalPages)
      );
    }

    function goExpiredPage(target) {
      expiredPage = Math.min(Math.max(1, target), expiredTotalPages);
      renderExpiredTable();
    }

    /* ===== ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ===== */
    async function loadData() {
      try {
        const url = `${GAS_URL}?action=read`;
        const res = await fetch(url, { method: 'GET' });
        const text = await res.text(); // ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô text ‡πÄ‡∏û‡∏∑‡πà‡∏≠ debug ‡∏á‡πà‡∏≤‡∏¢
        if (!res.ok) {
          console.error('GET failed:', res.status, res.statusText, text);
          throw new Error(`HTTP ${res.status}`);
        }
        const data = text ? JSON.parse(text) : [];
        currentData = Array.isArray(data) ? data : [];
        expiredPage = 1;
        renderExpiredTable();
        return currentData;
      } catch (err) {
        console.error('loadData error:', err);
        document.getElementById("status").textContent = "‚ö†Ô∏è ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏î‡∏π Console)";
        return [];
      }
    }

    /* ===== ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ===== */
    async function addDoc() {
      if (!document.getElementById('docForm').checkValidity()) {
        document.getElementById("status").textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á";
        return;
      }

      await loadData(); // ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ

      const doc = {
        dept: document.getElementById('dept').value,
        code: document.getElementById('code').value,
        rev: document.getElementById('rev').value,
        title: document.getElementById('title').value,
        startDate: document.getElementById('startDate').value,
        endDate: document.getElementById('endDate').value,
        fileType: document.getElementById('fileType').value,
        link: document.getElementById('link').value,
        category: document.querySelector('input[name="category"]:checked').value,
        printType: document.querySelector('input[name="printType"]:checked')?.value || "-"
      };

      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÉ‡∏ô currentData
      const index = currentData.findIndex(item => item.code === doc.code);
      if (index !== -1) currentData[index] = doc;
      else currentData.push(doc);

      try {
        const res = await fetch(GAS_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" }, // simple request
          body: JSON.stringify({ action: "write", data: currentData })
        });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const json = await res.json();
        if (json?.ok === false) throw new Error(json.error || "GAS not ok");

        clearForm();
        document.getElementById("status").textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        loadData();
      } catch (err) {
        console.error("addDoc write error:", err);
        document.getElementById("status").textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏õ‡∏¥‡∏î Console ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)";
      }
    }

    /* ===== ‡∏•‡∏ö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ===== */
    async function deleteDoc() {
      const code = document.getElementById('code').value.trim();
      if (!code) {
        document.getElementById("status").textContent = "‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö";
        return;
      }

      await loadData();

      const index = currentData.findIndex(item => item.code === code);
      if (index === -1) {
        document.getElementById("status").textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö";
        return;
      }

      if (!confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ${code} ?`)) return;
      currentData.splice(index, 1);

      try {
        const res = await fetch(GAS_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify({ action: "write", data: currentData })
        });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const json = await res.json();
        if (json?.ok === false) throw new Error(json.error || "GAS not ok");

        clearForm();
        document.getElementById("status").textContent = "üóëÔ∏è ‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        loadData();
      } catch (err) {
        console.error("deleteDoc write error:", err);
        document.getElementById("status").textContent = "‚ùå ‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏õ‡∏¥‡∏î Console ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)";
      }
    }

    /* ===== ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™ ===== */
    function searchDoc() {
      const code = document.getElementById('searchCode').value.trim();
      const found = currentData.find(item => item.code === code);
      if (found) {
        document.getElementById('dept').value = found.dept || "";
        document.getElementById('code').value = found.code || "";
        document.getElementById('rev').value = found.rev || "";
        document.getElementById('title').value = found.title || "";
        document.getElementById('startDate').value = found.startDate || "";
        document.getElementById('endDate').value = found.endDate || "";
        document.getElementById('fileType').value = found.fileType || "";
        document.getElementById('link').value = found.link || "";

        const printRadio = document.querySelector(`input[name="printType"][value="${found.printType}"]`);
        if (printRadio) printRadio.checked = true;

        const catRadio = document.querySelector(`input[name="category"][value="${found.category}"]`);
        if (catRadio) catRadio.checked = true;

        document.getElementById("status").textContent = "‚úèÔ∏è ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç";
      } else {
        document.getElementById("status").textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ";
      }
    }

    /* ===== ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° ===== */
    function clearForm() {
      document.getElementById('docForm').reset();
      document.getElementById('searchCode').value = "";
      document.getElementById('fileType').value = "";
      document.querySelector('input[name="category"][value="master"]').checked = true;
      document.querySelector('input[name="printType"][value="-"]').checked = true;
      document.getElementById("status").textContent = "üßº ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß";
    }

    /* ===== ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ä‡πà‡∏≠‡∏á fileType ‡∏ï‡∏≤‡∏° radio ===== */
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('input[name="fileTypeRadio"]').forEach(radio => {
        radio.addEventListener('change', function () {
          const fileTypeInput = document.getElementById('fileType');
          if (this.value === 'other') {
            fileTypeInput.disabled = false;
            fileTypeInput.value = '';
          } else {
            fileTypeInput.disabled = true;
            fileTypeInput.value = this.value;
          }
        });
      });
    });

    /* ===== ‡∏Å‡∏î Enter ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ===== */
    document.getElementById("adminPassword").addEventListener("keypress", function (e) {
      if (e.key === "Enter") {
        e.preventDefault();
        checkPassword();
      }
    });
  </script>
</body>
</html>
